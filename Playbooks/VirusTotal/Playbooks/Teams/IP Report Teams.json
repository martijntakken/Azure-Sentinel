{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "Playbook Name": {
            "defaultValue": "VirusTotal-IP-Teams",
            "type": "String",
            "metadata": {
                "description": "Name of the Logic App/Playbook"
            }
        }
    },
    "variables": {
        "AzureSentinelConnectionName": "[concat('azuresentinel-', parameters('Playbook Name'))]",
        "TeamsConnectionName": "[concat('teamsconnector-', parameters('Playbook Name'))]",
        "VirusTotalConnectionName": "[concat('VirusTotal-', parameters('Playbook Name'))]"
    },
    "resources": [
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('AzureSentinelConnectionName')]",
            "location": "[resourceGroup().location]",
            "dependsOn": [
            ],
            "properties": {
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                }
            }
        },
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('TeamsConnectionName')]",
            "location": "[resourceGroup().location]",
            "dependsOn": [
            ],
            "properties": {
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/teams')]"
                }
            }
        },
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('VirusTotalConnectionName')]",
            "location": "[resourceGroup().location]",
            "dependsOn": [
            ],
            "properties": {
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/VirusTotal')]"
                }
            }
        },
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('Playbook Name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('TeamsConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('VirusTotalConnectionName'))]"
            ],
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        }
                    },
                    "triggers": {
                        "When_Azure_Sentinel_incident_creation_rule_was_triggered_(Private_Preview_only)": {
                            "type": "ApiConnectionWebhook",
                            "inputs": {
                                "body": {
                                    "callback_url": "@{listCallbackUrl()}"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "path": "/incident-creation"
                            }
                        }
                    },
                    "actions": {
                        "Entities_-_Get_IPs": {
                            "runAfter": {},
                            "type": "ApiConnection",
                            "inputs": {
                                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/entities/ip"
                            }
                        },
                        "For_each": {
                            "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
                            "actions": {
                                "Get_an_IP_report": {
                                    "runAfter": {},
                                    "type": "ApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['VirusTotal']['connectionId']"
                                            }
                                        },
                                        "method": "get",
                                        "path": "/api/v3/ip_addresses/@{encodeURIComponent(items('For_each')?['Address'])}"
                                    }
                                },
                                "Post_adaptive_card_in_a_chat_or_channel": {
                                    "runAfter": {
                                        "Get_an_IP_report": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection",
                                    "inputs": {
                                        "body": {
                                            "messageBody": "{\n    \"type\": \"AdaptiveCard\",\n    \"body\": [\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"width\": \"auto\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"url\": \"https://connectoricons-prod.azureedge.net/releases/v1.0.1440/1.0.1440.2331/azuresentinel/icon.png\",\n\"Size\": \"Medium\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"Column\",\n                    \"width\": \"auto\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"url\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAADmCAYAAADBavm7AAAKx2lDQ1BEaXNwbGF5AABIiZWXd1BT+RbHv/emEhJaAgJSQu9KkSKIhE4ognSwEZLQiTEE7J3FFVwLKiJYVqzYcC2ArBULtkWsYF1Qsa+LuthQeX/wCPvevJk3e2bu3M985/y+55zf3D/OBThMkVyeR2oB+TKlIjY0gJ+ckspnPAEJLjRgDY5IXCD3j4mJBIDB99+CAD7cBgEAN5xEcnke/lloS6QFYoCIAZAuKRDnA8RhgHgjliuUAGUbAIvpSrkSoFwAwFMkp6QClPsAeJkD3AOAl56ckgpQqQB4ivjYQICqDzDZIpEiE2BbAuAXiTOVADsIgLNMki0D2EoAY8VZIgnAPgzAMT9/qgRgdwKwTf+bT+Z/eKarPEWiTBUPzAIAYAZlF8jzRDP/4XX8/8jPKxysYQ2AnaUIiwWgBxAduVMjVCxLHxc9yNkSYJCzCsMSBllcEJg6yBJRUITqbN64yEHOyA4RqnyUwvhBlhYExw2yYmqsqlaGItB/kEWKobqFuQkqPUsqVPnPyopPGuSi7MRxg1yQGxcxlBOo0hWFsar+pbLQgKG6IarZ8wv+Nm+2UHVWmRUfpppdNNS/VOY/5FmQrOpNIg0KHspJUOXLlQGqWvK8GFW+NC9UpRcUxanOKhXxQ/nKGNUd5ojCYwYZQQhGJCLBRwJc4Q4XuCMMUEpnKAEgcKp8piI7M0vJ95fL86R8oUw8wpHv6uzqDCSnpPIHPon3HSAAEHrMIW1qG+BZC2DnkCZKAxoLAF2LIc1qO6D5BDguFhcqigY0KgDQwIImeDCACSxgCye4wgM+ECAY4YhGPFIwGWJkIR8KTMccLEQJyrASa1GFzdiKXdiHg2jAMZzGeVxGG27hHjrRjVfowQf0EQTBIDgElzAgTAkrwoFwJbyIsUQwEUnEEilEGpFJyIhCYg6xmCgjyokqYgtRS/xCHCVOExeJa8Qdoot4QbwjvpAUkk3ySGPSmhxJepH+ZAQZT04iM8lp5CyymFxOVpI15F6ynjxNXiZvkZ3kK7KXAoo6RY9iRnGieFECKdGUVEoGRUGZRymlVFBqKPspTZQWyg1KJ+U15TOVTuVS+VQnqg81jJpAFVOnUedRl1GrqLuo9dSz1BvULmoP9TuNQzOiOdC8aUJaMi2TNp1WQqug7aAdoZ2j3aJ10z7Q6XQ9ug3dkx5GT6Hn0GfTl9E30uvop+jX6I/pvQwGw4DhwPBlRDNEDCWjhLGesZdxknGd0c34xFRnmjJdmSHMVKaMuYhZwdzNPMG8znzG7FPTUrNS81aLVpOozVRbobZNrUntqlq3Wh9Lm2XD8mXFs3JYC1mVrP2sc6z7rPfq6urm6qPVx6tnqy9Qr1Q/oH5BvUv9M1uHbc8OZE9kF7KXs3eyT7HvsN9zOBxrjoCTylFylnNqOWc4DzmfNLgaIzSEGhKN+RrVGvUa1zXeaKppWmn6a07WnKVZoXlI86rmay01LWutQC2R1jytaq2jWu1avdpcbRftaO187WXau7Uvaj/XYehY6wTrSHSKdbbqnNF5zKVwLbiBXDF3MXcb9xy3m0fn2fCEvBxeGW8fr5XXo6ujO0o3UXeGbrXucd1OPYqetZ5QL09vhd5Bvdt6X4YZD/MfJh22dNj+YdeHfdQfri/Ql+qX6tfp39L/YsA3CDbINVhl0GDwwJBqaG843nC64SbDc4avh/OG+wwXDy8dfnD4XSPSyN4o1mi20VajK0a9xibGocZy4/XGZ4xfm+iZCExyTNaYnDB5Yco1HWuabbrG9KTpS74u35+fx6/kn+X3mBmZhZkVmm0xazXrM7cxTzBfZF5n/sCCZeFlkWGxxqLZosfS1DLKco7lHsu7VmpWXlZZVuusWqw+WttYJ1kvsW6wfm6jbyO0mWWzx+a+LcfWz3aabY3tTTu6nZddrt1GuzZ70t7dPsu+2v6qA+ng4ZDtsNHhmiPNcbSjzLHGsd2J7eTvVOS0x6lrhN6IyBGLRjSMeDPScmTqyFUjW0Z+d3Z3znPe5nzPRccl3GWRS5PLO1d7V7FrtetNN45biNt8t0a3t6McRklHbRrV4c51j3Jf4t7s/s3D00Phsd/jhaelZ5rnBs92L55XjNcyrwujaaMDRs8ffWz0Z28Pb6X3Qe8/fZx8cn12+zwfYzNGOmbbmMe+5r4i3y2+nWP5Y9PG/jy208/MT+RX4/dIYCGQCHYInvnb+ef47/V/E+AcoAg4EvAx0DtwbuCpIEpQaFBpUGuwTnBCcFXwwxDzkMyQPSE9oe6hs0NPhdHCIsJWhbULjYViYa2wJ9wzfG742Qh2RFxEVcSjSPtIRWRTFBkVHrU66v44q3GycQ3RiBZGr45+EGMTMy3m1/H08THjq8c/jXWJnRPbEseNmxK3O+5DfED8ivh7CbYJhQnNiZqJExNrEz8mBSWVJ3Umj0yem3w5xTAlO6UxlZGamLojtXdC8IS1E7onuk8smXh7ks2kGZMuTjacnDf5+BTNKaIph9JoaUlpu9O+iqJFNaLedGH6hvQecaB4nfiVRCBZI3kh9ZWWS59l+GaUZzzP9M1cnfkiyy+rIut1dmB2VfbbnLCczTkfc6Nzd+b25yXl1eUz89Pyj8p0ZLmys1NNps6Yek3uIC+Rd07znrZ2Wo8iQrGjgCiYVNCo5CnlyiuFtoU/FHYVjS2qLvo0PXH6oRnaM2Qzrsy0n7l05rNZIbO2z6bOFs9unmM2Z+Gcrrn+c7fMI+alz2uebzG/eH73gtAFuxayFuYu/G2R86LyRX8tTlrcVGxcvKD48Q+hP+wp0ShRlLQv8Vmy+Ufqj9k/ti51W7p+6fdSSemlMueyirKvy8TLLv3k8lPlT/3LM5a3rvBYsWklfaVs5e1Vfqt2lWuXzyp/vDpqdf0a/prSNX+tnbL2YsWois3rWOsK13VWRlY2rrdcv3L916qsqlvVAdV1G4w2LN3wcaNk4/VNgk37NxtvLtv85efsnzu2hG6pr7GuqdhK31q09em2xG0t27221+4w3FG249tO2c7OXbG7ztZ61tbuNtq9Yg+5p3DPi70T97btC9rXuN9p/5Y6vbqyAzhQeODlL2m/3D4YcbD5kNeh/YetDm84wj1SWk/Uz6zvachq6GxMabx2NPxoc5NP05FfR/y685jZserjusdXnGCdKD7Rf3LWyd5T8lOvT2eeftw8pfnemeQzN8+OP9t6LuLchfMh58+0+LecvOB74dhF74tHL3ldarjscbn+ivuVI7+5/3ak1aO1/qrn1ca20W1N18ZcO3Hd7/rpG0E3zt8U3rx8a9yta7cTbne0T2zv7JB0PL+Td+ft3aK7ffcW3KfdL32g9aDiodHDmt/tfq/r9Og83hXUdeVR3KN7j8WPXz0pePK1u/gp52nFM9Nntc9dnx97EfKi7eWEl92v5K/6Xpf8of3Hhje2bw7/KfjzSk9yT/dbxdv+d8veG7zf+deov5p7Y3offsj/0Pex9JPBp12fvT63fEn68qxv+lfG18pvdt+avkd8v9+f398vFylEAAAKADIjA3i3E+CkANw2gDVhYKcGABAD/wHAwA7yv3lg7wYAeAC1AiABQJQA2AjAWgBoCoAYARAvAOnmpnr+HQUZbq4DXuoNAK2iv/99EsCwA7619/f3NfT3f9sBUO4Cpz4M7PIAoLUXaJM5R4RHXnd17MB/xb8Ax3kQ0vMQ8YoAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAXtaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA2LjAtYzAwMiA3OS4xNjQzNTIsIDIwMjAvMDEvMzAtMTU6NTA6MzggICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMS4xIChNYWNpbnRvc2gpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMC0wNC0xMlQxMDowODoyNyswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0wNC0xMlQxMDowODoyNyswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjAtMDQtMTJUMTA6MDg6MjcrMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Yzc3Y2Q0NWQtMWYxMi00NGJkLWJhNmQtNzQ0YmQ5MTg4MGE0IiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YTJmYjhkNmItMTFmZC1iYzRkLTgwYTYtOWZhMjlkOGY5NjMwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZGFkZGJkZGEtYWMzOS00YjcxLWI1MzAtYTgyNDhkNDI3YzFhIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9IkRpc3BsYXkiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmRhZGRiZGRhLWFjMzktNGI3MS1iNTMwLWE4MjQ4ZDQyN2MxYSIgc3RFdnQ6d2hlbj0iMjAyMC0wNC0xMlQxMDowODoyNyswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmM3N2NkNDVkLTFmMTItNDRiZC1iYTZkLTc0NGJkOTE4ODBhNCIgc3RFdnQ6d2hlbj0iMjAyMC0wNC0xMlQxMDowODoyNyswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+9pNfcAAAMtZJREFUeJztfemfVcW19lPn9EwPdJ9GjYqGaNQ44BREZR40xhCVxPv7vX/E+z/djzf3fb0Rhxg1yCCgKEZNIOKIAygoPU/0dE7dD1VrqH0aowJn7+5ejwl9zj57qF1Vz1qrVq1a5Y68/7GHwWAoFEp5F8BgMNTDiGkwFBBGTIOhgDBiGgwFhBHTYCggjJgG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\",\n\"Size\": \"Medium\"\n                        }\n                    ],\n                    \"minHeight\": \"1px\"\n                }\n            ]\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"size\": \"Medium\",\n            \"weight\": \"Bolder\",\n            \"text\": \"@{triggerBody()?['object']?['properties']?['title']}\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"New @{triggerBody()?['object']?['properties']?['severity']} incident @{triggerBody()?['object']?['properties']?['title']} by @{join(triggerBody()?['object']?['properties']?['additionalData']?['alertProductNames'], ',')} (@{triggerBody()?['object']?['properties']?['incidentNumber']}).\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Related IP address: @{items('For_each')?['Address']}\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"@{triggerBody()?['object']?['properties']?['description']}\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"FactSet\",\n            \"facts\": [\n                {\n                    \"title\": \"Harmless:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['last_analysis_stats']?['harmless']}\"\n                },\n                {\n                    \"title\": \"Malicious:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['last_analysis_stats']?['malicious']}\"\n                },\n                {\n                    \"title\": \"Suspicious:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['last_analysis_stats']?['suspicious']}\"\n                },\n                {\n                    \"title\": \"Timeout:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['last_analysis_stats']?['timeout']}\"\n                },\n                {\n                    \"title\": \"Undetected:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['last_analysis_stats']?['undetected']}\"\n                }\n            ]\n        },\n        {\n            \"type\": \"FactSet\",\n            \"facts\": [\n                {\n                    \"title\": \"Country:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['country']}\"\n                },                {\n                    \"title\": \"Continent:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['continent']}\"\n                },\n                {\n                    \"title\": \"Owner:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['as_owner']}\"\n                },\n                {\n                    \"title\": \"Total votes harmless:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['total_votes']?['harmless']}\"\n                },\n                {\n                    \"title\": \"Total votes harmless:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['total_votes']?['malicious']}\"\n                },\n                {\n                    \"title\": \"Reputation:\",\n                    \"value\": \"@{body('Get_an_IP_report')?['data']?['attributes']?['reputation']}\"\n                }\n]\n},\n        {\n            \"type\": \"ActionSet\",\n            \"actions\": [\n                {\n                    \"type\": \"Action.OpenUrl\",\n                    \"title\": \"Open incident\",\n                    \"url\": \"@{triggerBody()?['object']?['properties']?['incidentUrl']}\"\n                }\n            ]\n        }\n    ],\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n    \"version\": \"1.3\"\n}",
                                            "recipient": {
                                                "channelId": "",
                                                "groupId": ""
                                            }
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['teams']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/v1.0/teams/conversation/adaptivecard/poster/@{encodeURIComponent('Flow bot')}/location/@{encodeURIComponent('Channel')}"
                                    }
                                }
                            },
                            "runAfter": {
                                "Entities_-_Get_IPs": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach"
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
                    "$connections": {
                        "value": {
                            "azuresentinel": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                                "connectionName": "[variables('AzureSentinelConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                            },
                            "teams": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('TeamsConnectionName'))]",
                                "connectionName": "[variables('TeamsConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/teams')]"
                            },
                            "VirusTotal": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('VirusTotalConnectionName'))]",
                                "connectionName": "[variables('VirusTotalConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/VirusTotal')]"
                            }
                        }
                    }
                }
            }
        }
    ]
}